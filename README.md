This is an implementation of design3
